<!DOCTYPE html>
<meta charset="utf-8">
<style>
    .subunits {
    fill: none;
    }

    .state-borders {
    fill: none;
    stroke: #fff;
    stroke-linejoin: round;
    stroke-linecap: round;
    }

    .q0-90 { fill:rgb(247,251,255); }
    .q10-90 { fill:rgb(222,235,247); }
    .q20-90 { fill:rgb(198,219,239); }
    .q30-90 { fill:rgb(158,202,225); }
    .q40-90 { fill:rgb(107,174,214); }
    .q50-90 { fill:rgb(66,146,198); }
    .q60-90 { fill:rgb(33,113,181); }
    .q70-90 { fill:rgb(8,81,156); }
    .q80-90 { fill:rgb(8,48,107); }
</style>

<body>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script>
    var width = 960,
        height = 550;

    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height);

    var quantize = d3.scale.quantize()
        .domain([0, 90])
        .range(d3.range(0, 100, 10).map(function(i) { return "q" + i + "-90"; }));

    console.log(quantize(0.51))
    console.log(d3.range(0,1,0.1))

    var mainGroup = svg.append("g");
    mainGroup.style({ stroke: "white", "stroke-width": "2px", "stroke-opacity": 0.0 });

    var projection = d3.geo.mercator()
        .scale(1)
        .translate([0, 0]);

    var path = d3.geo.path()
        .projection(projection);



    d3.json("nld.json", function(error, nld) {
            console.log(nld);

            var l = topojson.feature(nld, nld.objects.subunits).features[3],
                b = path.bounds(l),
                s = .2 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height),
                t = [(width - s * (b[1][0] + b[0][0])) / 2, (height - s * (b[1][1] + b[0][1])) / 2];

            console.log(l)
            console.log(topojson.feature(nld, nld.objects.subunits).features[1].properties.rate)
            projection
                .scale(s)
                .translate(t);

            var colour = d3.scale.category20();

            var subunits = topojson.feature(nld, nld.objects.subunits).features;

            mainGroup.selectAll("path", "subunits")
                .data(subunits)
                .enter().append("path")
                .attr("d", path)
                .attr("class", function(d) {
                    return quantize(d.properties.rate);
                })

            mainGroup.selectAll("path")
                .on("mouseover", function () {
                    console.log("mouseover");
                    d3.select(this).style("stroke-opacity", 1.0);
                });
            mainGroup.selectAll("path")
                .on("mouseout", function () {
                    d3.select(this).style("stroke-opacity", 0.0);
                });
    });
    </script>
</body>
</html>